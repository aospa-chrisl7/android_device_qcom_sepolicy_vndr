# Copyright (c) 2022-2024 Qualcomm Innovation Center, Inc. All rights reserved.
# SPDX-License-Identifier: BSD-3-Clause-Clear

neverallow {
  vendor_halserverdomain
  -vendor_hal_fstman
  -vendor_hal_dpmapiservice_qti
  -vendor_wigignpt
  -vendor_cnd
  -vendor_qms
  userdebug_or_eng(` -vendor_hal_diaghal')
  userdebug_or_eng(` -vendor_wifimyftmsvc')
} self:global_capability_class_set { net_admin net_raw };

neverallow {
  vendor_halserverdomain
  -vendor_cnd
  -vendor_hal_datafactory_qti
  -vendor_hal_sxrservice_qti
  -vendor_hal_qvrservice_qti
  -vendor_hal_fstman
  -vendor_wifidisplayhalservice_qti
  -vendor_ims_service
  -vendor_ims_dcservice
  -vendor_dpmd_vndr
  -vendor_qtidataservices_app
  -vendor_hal_dpmQmiMgr
  -vendor_qms
  -vendor_hal_imsrtp
  -vendor_cacertservice_app
  userdebug_or_eng(` -vendor_hal_diaghal')
  userdebug_or_eng(` -vendor_qtiloopback_native')
  userdebug_or_eng(` -vendor_wifimyftmsvc')
} domain:{ tcp_socket udp_socket rawip_socket } *;

neverallow {
  vendor_halserverdomain
  - vendor_qtidataservices_app
  - vendor_cacertservice_app
  userdebug_or_eng(` -vendor_wifimyftmsvc')
} {
file_type
fs_type
-shell_exec
-toolbox_exec
}:file execute_no_trans;

neverallow { domain -init } vendor_halserverdomain:process transition;
neverallow *  { vendor_halserverdomain - vendor_qtidataservices_app - vendor_cacertservice_app }:process dyntransition;
