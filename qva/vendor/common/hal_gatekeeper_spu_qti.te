# Copyright (c) 2023-2024 Qualcomm Innovation Center, Inc. All rights reserved.
# SPDX-License-Identifier: BSD-3-Clause-Clear

allow vendor_hal_gatekeeper_spu_qti vendor_spcom_device:chr_file rw_file_perms;

# allow access to skp
allow vendor_hal_gatekeeper_spu_qti vendor_skp_device:chr_file rw_file_perms;

#allow access to /dev/spss_utils
allow vendor_hal_gatekeeper_spu_qti vendor_spss_utils_device:chr_file rw_file_perms;

allow vendor_hal_gatekeeper_spu_qti vendor_sp_keymaster_device:chr_file rw_file_perms;
get_prop(vendor_hal_gatekeeper_spu_qti, vendor_spcomlib_prop)

get_prop(vendor_hal_gatekeeper_spu_qti, vendor_disable_spu_prop)

# Allow access to HLOS<=>SPU share buffers
allow vendor_hal_gatekeeper_spu_qti vendor_dmabuf_sp_hlos_heap_device:chr_file r_file_perms;
allow vendor_hal_gatekeeper_spu_qti vendor_dmabuf_system_heap_device:chr_file r_file_perms;

# Allow hyp_assign() for HLOS<=>SP share buffers (r_file_perms includes ioctl)
allow vendor_hal_gatekeeper_spu_qti vendor_vm_hlos_device:chr_file r_file_perms;
allow vendor_hal_gatekeeper_spu_qti vendor_vm_cp_spss_sp_device:chr_file r_file_perms;
allow vendor_hal_gatekeeper_spu_qti vendor_vm_cp_spss_sp_shared_device:chr_file r_file_perms;
allow vendor_hal_gatekeeper_spu_qti vendor_vm_cp_spss_hlos_shared_device:chr_file r_file_perms;
allow vendor_hal_gatekeeper_spu_qti vendor_membuf_dev:chr_file r_file_perms;

# Allow read vendor TEE listener ready property
get_prop(vendor_hal_gatekeeper_spu_qti, vendor_tee_listener_prop)

# As each dma buf is seperate device, need to allow access to those devices
allow vendor_hal_gatekeeper_spu_qti vendor_dmabuf_qseecom_heap_device:chr_file r_file_perms;
allow vendor_hal_gatekeeper_spu_qti vendor_dmabuf_secure_sp_tz_heap_device:chr_file r_file_perms;

# Access to wakelock sysfs
wakelock_use(vendor_hal_gatekeeper_spu_qti)
