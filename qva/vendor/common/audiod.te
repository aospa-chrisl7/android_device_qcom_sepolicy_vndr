#Copyright (c) 2023 Qualcomm Innovation Center, Inc. All rights reserved.
#SPDX-License-Identifier: BSD-3-Clause-Clear
#

# audio daemon
type vendor_audiod, domain;
type vendor_audiod_exec, exec_type, vendor_file_type, file_type;

init_daemon_domain(vendor_audiod)

hal_client_domain(vendor_audiod, hal_audio)
hal_client_domain(vendor_audiod, hal_vehicle)

allow vendor_audiod proc_asound:dir search;
allow vendor_audiod proc_asound:file read;
allow vendor_audiod vendor_proc_audiod:file r_file_perms;
allow vendor_audiod audio_device:dir r_dir_perms;
allow vendor_audiod audio_device:chr_file rw_file_perms;

# Allow vendor_audiod to read silent mode node
allow vendor_audiod sysfs_power:file r_file_perms;

# Allow vendor_audiod to communicate with Audio HAL Plugin Service
allow vendor_audiod vendor_audio_hal_plugin_service_service:service_manager find;
allow vendor_audiod vendor_audiohalservice_qti_service:service_manager find;
allow vendor_audiod vendor_android_hardware_audio_service_aidl_qti_service:service_manager find;
binder_call(vendor_audiod, vendor_audio_hal_plugin_service)
binder_call(vendor_audiod, vendor_audiohalservice_qti)
binder_call(vendor_audiod, vendor_android_hardware_audio_service_aidl_qti)
binder_call(vendor_audiod, vendor_android_hardware_audio_effect_service_aidl_qti)
vndbinder_use(vendor_audiod)
wakelock_use(vendor_audiod);
allow vendor_audiod vendor_sysfs_kpi:file w_file_perms;
allow vendor_audiod vendor_sysfs_sndcard:file r_file_perms;
carpowerpolicy_callback_domain(vendor_audiod)
allow vendor_audiod carpowerpolicyd_service:service_manager find;
