#Copyright (c) 2024 Qualcomm Innovation Center, Inc. All rights reserved.
#SPDX-License-Identifier: BSD-3-Clause-Clear

type vendor_android_hardware_audio_service_aidl_qti, domain;
type vendor_android_hardware_audio_service_aidl_qti_exec, exec_type, vendor_file_type, file_type;

init_daemon_domain(vendor_android_hardware_audio_service_aidl_qti)
hal_server_domain(vendor_android_hardware_audio_service_aidl_qti,hal_audio)

allow vendor_android_hardware_audio_service_aidl_qti audio_device:dir search;
allow vendor_android_hardware_audio_service_aidl_qti audio_device:chr_file rw_file_perms;
vndbinder_use(vendor_android_hardware_audio_service_aidl_qti)
add_service(vendor_android_hardware_audio_service_aidl_qti, vendor_android_hardware_audio_service_aidl_qti_service)

binder_call(vendor_android_hardware_audio_service_aidl_qti,servicemanager)
binder_call(vendor_android_hardware_audio_service_aidl_qti,audioserver)

allow hal_audio_service vendor_android_hardware_audio_service_aidl_qti:service_manager { find add };
allow bluetooth_a2dp_offload_prop vendor_android_hardware_audio_service_aidl_qti:file read;
allow bluetooth_audio_hal_prop vendor_android_hardware_audio_service_aidl_qti:file read;

dontaudit hal_audio_service vendor_android_hardware_audio_service_aidl_qti:service_manager add;
dontaudit bluetooth_a2dp_offload_prop vendor_android_hardware_audio_service_aidl_qti:file read;
dontaudit bluetooth_audio_hal_prop vendor_android_hardware_audio_service_aidl_qti:file read;

dontaudit vendor_android_hardware_audio_service_aidl_qti default_prop:file read;
#allow vendor_android_hardware_audio_service_aidl_qti default_prop:file read;
#allow vendor_acdb_loader_service vendor_android_hardware_audio_service_aidl_qti:service_manager find;
allow vendor_android_hardware_audio_service_aidl_qti vendor_acdb_loader_service_service:service_manager find;
